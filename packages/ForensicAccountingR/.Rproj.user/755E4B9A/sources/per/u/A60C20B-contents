require("data.table")
conn <- DBI::dbConnect(odbc::odbc(), Driver = "SQL Server", Server = "localhost", Database = "ExpenseReports", Trusted_Connection = "True")
#install.packages("odbc", repos = "http://archive.linux.duke.edu/cran/")
expenseReports <- DBI::dbGetQuery(conn, "
SELECT
	er.EmployeeID,
  CONCAT(e.FirstName, ' ', e.LastName) AS EmployeeName,
  ec.ExpenseCategoryID,
  ec.ExpenseCategory,
  er.ExpenseDate,
  YEAR(er.ExpenseDate) AS ExpenseYear,
  er.Amount
FROM dbo.ExpenseReport er
  INNER JOIN dbo.ExpenseCategory ec
    ON er.ExpenseCategoryID = ec.ExpenseCategoryID
  INNER JOIN dbo.Employee e
    ON e.EmployeeID = er.EmployeeID
WHERE
  er.ExpenseDate < '2017-01-01';
")

erData <- expenseReports
erData[, c("ExpenseCategoryID", "ExpenseYear")]

